<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>跑步计算器</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            padding: 20px;
            max-width: 800px;
            margin: auto;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        fieldset {
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        legend {
            font-weight: bold;
            padding: 0 10px;
            font-size: 1.1em;
            color: #34495e;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        td {
            padding: 8px 5px;
        }
        td:nth-child(1), td:nth-child(3) {
            width: 25%;
            text-align: right;
            padding-right: 10px;
        }
        td:nth-child(2), td:nth-child(4) {
            width: 25%;
        }
        input[type="text"] {
            width: 90%;
            border: 1px solid #ccc;
            padding: 6px 8px;
            border-radius: 4px;
            font-size: 1em;
        }
        input[type="text"]:read-only {
            background-color: #ecf0f1;
            border-style: inset;
            border-color: #bdc3c7;
        }
        .time-input-group input[type="text"] {
            width: 40px;
            text-align: center;
        }
        .input-section {
            padding-left: 20px;
        }
        .input-section label {
             margin: 0 10px 0 5px;
        }
        input[type="button"] {
            padding: 8px 20px;
            border-radius: 5px;
            border: none;
            background-color: #3498db;
            color: white;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        input[type="button"]:hover {
            background-color: #2980b9;
        }
        .note {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 15px;
            text-align: center;
        }
    </style>
</head>
<body>

    <h1>跑步计算器</h1>

    <form name="inputs" onsubmit="return false;">
        <fieldset>
            <legend>输入最近一次比赛成绩，预测在其他比赛中的用时：</legend>
            <div class="input-section">
                <p>
                    时间 (小时:分钟:秒):
                    <span class="time-input-group">
                        <input type="text" name="hours" size="2" maxlength="2" value="00"> :
                        <input type="text" name="hours1" size="2" maxlength="2" value="00"> :
                        <input type="text" name="hours2" size="2" maxlength="2" value="00">
                    </span>
                </p>
                <p>
                    距离和单位:
                    <input type="text" name="distance" size="8">
                    <input type="radio" name="units" value="miles" id="miles"><label for="miles">Miles(英里)</label>
                    <input type="radio" name="units" value="km" id="km" checked><label for="km">Kilometers(公里)</label>
                </p>
                <p>
                    <input type="button" value="计算" onclick="runcalcs()">
                </p>
            </div>
        </fieldset>
    </form>

    <form name="equivtimes" onsubmit="return false;">
         <fieldset>
            <legend>预测结果:</legend>
            <table>
                <tbody><tr>
                    <td>800米</td>
                    <td><input type="text" name="t800" readonly=""></td>
                    <td>5公里</td>
                    <td><input type="text" name="t5k" readonly=""></td>
                </tr>
                <tr>
                    <td>1500米</td>
                    <td><input type="text" name="t1500" readonly=""></td>
                    <td>10公里</td>
                    <td><input type="text" name="t10k" readonly=""></td>
                </tr>
                <tr>
                    <td>1英里</td>
                    <td><input type="text" name="tmile" readonly=""></td>
                    <td>10英里</td>
                    <td><input type="text" name="t10mile" readonly=""></td>
                </tr>
                <tr>
                    <td>3000米</td>
                    <td><input type="text" name="t3000" readonly=""></td>
                    <td>半程马拉松</td>
                    <td><input type="text" name="thalfm" readonly=""></td>
                </tr>
                 <tr>
                    <td>2英里</td>
                    <td><input type="text" name="t2mile" readonly=""></td>
                    <td>马拉松</td>
                    <td><input type="text" name="tmarathon" readonly=""></td>
                </tr>
            </tbody></table>
            <p class="note">注意：本预测结果仅供参考。</p>
        </fieldset>
    </form>


    <form name="paces" onsubmit="return false;">
        <fieldset>
            <legend>专项训练中的配速参考:</legend>
            <table>
                 <tbody><tr>
                    <td>Easy(放松跑)</td>
                    <td><input type="text" name="easy" readonly=""></td>
                    <td>Speed(竞速跑)</td>
                    <td><input type="text" name="speed" readonly=""></td>
                </tr>
                 <tr>
                    <td>Tempo(LT)(节奏跑)</td>
                    <td><input type="text" name="tempo" readonly=""></td>
                    <td>Long Run(长距离)</td>
                    <td><input type="text" name="plong" readonly=""></td>
                </tr>
                 <tr>
                    <td>VO2 Max(最大摄氧量跑)</td>
                    <td><input type="text" name="vo2max" readonly=""></td>
                    <td>Marathon(马拉松)</td>
                    <td><input type="text" name="marathon" readonly=""></td>
                </tr>
            </tbody></table>
        </fieldset>
    </form>

<script>
function runcalcs(){
	var racetime = 0;
	var racelength = 0;
	var racespeed = 0;
	racetime = document.forms.inputs.hours.value * 60;
	racetime += document.forms.inputs.hours1.value * 1;
	racetime += document.forms.inputs.hours2.value / 60;
	if(racetime <= 0 || isNaN(racetime)){
		alert("您没有输入有效的时间。");
		return;
		}
	racelength = document.forms.inputs.distance.value * 1;
	if(racelength <=0 || isNaN(racelength)){
		alert("您没有输入有效的距离。");
		return;
		}
	if(document.forms.inputs.units[0].checked) racelength *= 1609.344;
	else racelength *= 1000;

	var intime = racetime * 60;
	var indist = racelength / 1609.344;
	var fac = intime / ((3600 / (13.49681 - (.048865 * indist) + (2.438936 / (Math.pow(indist,0.7905))))) * indist);
	if (!isFinite(fac)) { // Check for invalid calculation result
		// Clear fields or show error
		return;
	}

	document.forms.equivtimes.t800.value = "" + convtotime(fac*101.020796);
	document.forms.equivtimes.t1500.value = "" + convtotime(fac*209.56359);
	document.forms.equivtimes.tmile.value = "" + convtotime(fac*226.60206);
	document.forms.equivtimes.t3000.value = "" + convtotime(fac*450.46813);
	document.forms.equivtimes.t2mile.value = "" + convtotime(fac*486.18638);
	document.forms.equivtimes.t5k.value = "" + convtotime(fac*779.978107);
	document.forms.equivtimes.t10k.value = "" + convtotime(fac*1625.00956);
	document.forms.equivtimes.t10mile.value = "" + convtotime(fac*2685.914933);
	document.forms.equivtimes.thalfm.value = "" + convtotime(fac*3581.90674);
	document.forms.equivtimes.tmarathon.value = "" + convtotime(fac*7611.95023);

	racespeed = racelength / racetime;
	var VO2max = (-4.6 + .182258 * racespeed + .000104 * racespeed * racespeed) / (.8 + .1894393 * Math.exp(-.012778 * racetime) + .2989558 * Math.exp(-.1932695 * racetime));
	
    if (!isFinite(VO2max)) { // Check for invalid calculation result
		// Clear fields or show error
		return;
	}

	document.forms.paces.easy.value = calcpace(VO2max * .7);
	document.forms.paces.tempo.value = calcpace(VO2max * .88);
	document.forms.paces.vo2max.value = calcpace(VO2max);
	document.forms.paces.speed.value = calcpace(VO2max * 1.1);
	document.forms.paces.plong.value = "" + calcpace(VO2max * .75) + " to " + calcpace(VO2max * .6);
	document.forms.paces.marathon.value = calcpace(VO2max * .823);
}

function calcpace(VO2){
	var pace = 0;
	var pacevel = (29.54 + 5.000663 * VO2 - .007546 * VO2 * VO2);
	
	if (pacevel <= 0) {
		return "N/A";
	}
	
	if(document.forms.inputs.units[0].checked) {
		pace = (1 / pacevel) * 1609.344;
	} else {
		pace = (1 / pacevel) * 1000;
	}

	var minutes = Math.floor(pace);
	var seconds = Math.round((pace - minutes) * 60);

    if (seconds === 60) {
        minutes += 1;
        seconds = 0;
    }

	if(seconds < 10) {
		return "" + minutes + ":0" + seconds;
	} else {
		return "" + minutes + ":" + seconds;
	}
}

function convtotime(timesec){
	if (!isFinite(timesec) || timesec < 0) {
		return "N/A";
	}
	var hours = Math.floor(timesec/3600);
	var minutes = Math.floor((timesec - hours*3600)/60);
	var seconds = Math.round(timesec - hours*3600 - minutes*60);

    if (seconds === 60) {
        minutes += 1;
        seconds = 0;
    }
    if (minutes === 60) {
        hours += 1;
        minutes = 0;
    }

	var sec_str = (seconds < 10) ? ":0" + seconds : ":" + seconds;
	var min_str = "";

	if(hours > 0) {
		min_str = (minutes < 10) ? ":0" + minutes : ":" + minutes;
		return "" + hours + min_str + sec_str;
	} else {
		return "" + minutes + sec_str;
	}
}
</script>

</body>
</html>